{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/taeeun/Desktop/Programming/Projects/work-time-calc/pages/index.js\",\n    _this2 = this,\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport styled from 'styled-components';\nimport useWindowSize from '../hooks/useWindowSize';\nimport useInput from '../hooks/useInput';\nvar Main = styled.main.withConfig({\n  displayName: \"pages__Main\",\n  componentId: \"cqz4mh-0\"\n})([\"background-color:#eceae9;display:flex;flex-direction:column;justify-content:center;align-items:center;\"]);\n_c = Main;\nvar FileInput = styled.label.withConfig({\n  displayName: \"pages__FileInput\",\n  componentId: \"cqz4mh-1\"\n})([\"color:#4c4a49;font-family:'GmarketSansMedium','\\uB098\\uB214\\uACE0\\uB515',NanumGothic,'\\uB3CB\\uC6C0',Dotum,sans-serif;font-size:3.5rem;line-height:2;text-shadow:1px 1px 1px #5c5a59;&:hover{transform:scale(1.1);transition:all 0.1s ease;};\"]);\n_c2 = FileInput;\nvar Button = styled.button.withConfig({\n  displayName: \"pages__Button\",\n  componentId: \"cqz4mh-2\"\n})([\"color:#4c4a49;font-family:'GmarketSansMedium','\\uB098\\uB214\\uACE0\\uB515',NanumGothic,'\\uB3CB\\uC6C0',Dotum,sans-serif;font-size:3.5rem;line-height:2;text-shadow:1px 1px 1px #5c5a59;&:hover{transform:scale(1.1);transition:all 0.1s ease;};\"]);\n_c3 = Button;\n\nfunction Worker(name) {\n  var _this = this;\n\n  this.name = name;\n  this.workTime = [];\n  this.bound = [];\n\n  this.getSum = function () {\n    return _this.workTime.reduce(function (result, data, b_idx) {\n      return result + data.reduce(function (_res, _d, i) {\n        if (_d === 0 && data[i - 1] === 1) {\n          _res--;\n        } else if (i === data.length - 1 && _d === 1) {\n          _res--;\n        }\n\n        return _res + _d;\n      }, 0) / 2 - _this.bound[b_idx] / 2;\n    }, 0);\n  };\n}\n\n_c4 = Worker;\n\nvar getElem = function getElem(sheet, i, R) {\n  var tmp = sheet[XLSX.utils.encode_cell({\n    c: i,\n    r: R\n  })];\n  var elem = 'UNKNOWN';\n  if (tmp && tmp.t) elem = XLSX.utils.format_cell(tmp);\n  return elem;\n};\n\nvar Home = function Home() {\n  _s();\n\n  var winSize = useWindowSize();\n\n  var _useState = useState(null),\n      mainFile = _useState[0],\n      setMainFile = _useState[1];\n\n  var _useState2 = useState(null),\n      workerList = _useState2[0],\n      setWorkerList = _useState2[1];\n\n  var _useState3 = useState(false),\n      resultPage = _useState3[0],\n      setResultPage = _useState3[1];\n\n  var _useState4 = useState(false),\n      fileUploaded = _useState4[0],\n      setFileUploaded = _useState4[1];\n\n  var parseFile = function parseFile(e) {\n    var reader = new FileReader();\n\n    reader.onload = function () {\n      var fileData = reader.result;\n      var wb = XLSX.read(fileData, {\n        type: 'binary'\n      });\n      var firstSheetName = wb.SheetNames[0];\n      var sheet = wb.Sheets[firstSheetName];\n      var mainSheet = [];\n      var range = XLSX.utils.decode_range(sheet['!ref']);\n\n      for (var R = 2; R <= range.e.r; ++R) {\n        var rowData = [];\n        rowData.push(getElem(sheet, 0, R));\n        rowData.push(getElem(sheet, 1, R));\n        rowData.push(getElem(sheet, 2, R));\n        mainSheet.push(rowData);\n      }\n\n      setMainFile(mainSheet);\n    };\n\n    alert(\"\".concat(e.target.files[0].name, \"\\uC774 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC5C5\\uB85C\\uB4DC \\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4\"));\n    reader.readAsBinaryString(e.target.files[0]);\n  };\n\n  var getResult = function getResult() {\n    mainFile.sort(function (a, b) {\n      if (a[0] < b[0]) {\n        return -1;\n      } else if (a[0] > b[0]) {\n        return 1;\n      } else {\n        if (a[1] < b[1]) {\n          return -1;\n        } else if (a[1] > b[1]) {\n          return 1;\n        }\n\n        return 0;\n      }\n    });\n    var workers = []; // array of Worker\n\n    var idx = 0;\n\n    var _loop = function _loop() {\n      var name = mainFile[idx][0];\n\n      if (name === 'UNKNOWN') {\n        idx++;\n        return \"continue\";\n      }\n\n      var rows = [];\n\n      var _worker = new Worker(name);\n\n      while (idx < mainFile.length && mainFile[idx][0] === name) {\n        rows.push(mainFile[idx++]);\n      }\n\n      var curDay = '';\n      var cur = -1;\n      rows.forEach(function (row) {\n        var beginDay = row[1].split(' ')[0];\n        var endDay = row[2].split(' ')[0];\n\n        if (curDay !== beginDay) {\n          if (_worker.workTime[cur + 1] === undefined) {\n            _worker.workTime.push(Array(49).fill(0));\n          }\n\n          if (_worker.bound[cur + 1] === undefined) {\n            _worker.bound.push(0);\n          }\n\n          curDay = beginDay;\n          cur++;\n        }\n\n        var beginTime = parseInt(row[1].split(' ')[2].split(':')[0]) + (row[1].split(' ')[2].split(':')[1] == 0 ? 0 : 0.5);\n        var endTime = parseInt(row[2].split(' ')[2].split(':')[0]) + (row[2].split(' ')[2].split(':')[1] == 0 ? 0 : 0.5);\n\n        if (beginDay === endDay) {\n          if (beginTime !== 0 && _worker.workTime[cur][beginTime * 2] === 0 && _worker.workTime[cur][beginTime * 2 - 1] === 1) {\n            _worker.bound[cur]++;\n          }\n\n          if (endTime !== 48 && _worker.workTime[cur][endTime * 2] === 0 && _worker.workTime[cur][endTime * 2 + 1] === 1) {\n            _worker.bound[cur]++;\n          }\n\n          for (var i = beginTime * 2; i <= endTime * 2; i++) {\n            _worker.workTime[cur][i] = 1;\n          }\n        } else {\n          if (_worker.workTime[cur + 1] === undefined) {\n            _worker.workTime.push(Array(49).fill(0));\n          }\n\n          if (_worker.bound[cur + 1] === undefined) {\n            _worker.bound.push(0);\n          }\n\n          if (beginTime !== 0 && _worker.workTime[cur][beginTime * 2] === 0 && _worker.workTime[cur][beginTime * 2 - 1] === 1) {\n            _worker.bound[cur]++;\n          }\n\n          if (endTime !== 48 && _worker.workTime[cur + 1][endTime * 2] === 0 && _worker.workTime[cur + 1][endTime * 2 + 1] === 1) {\n            _worker.bound[cur]++;\n          }\n\n          for (var _i = beginTime * 2; _i < 49; _i++) {\n            _worker.workTime[cur][_i] = 1;\n          }\n\n          for (var _i2 = 0; _i2 <= endTime * 2; _i2++) {\n            _worker.workTime[cur + 1][_i2] = 1;\n          }\n        }\n      });\n      workers.push(_worker);\n    };\n\n    while (idx < mainFile.length) {\n      var _ret = _loop();\n\n      if (_ret === \"continue\") continue;\n    }\n\n    setWorkerList(workers);\n    setResultPage(true);\n  };\n\n  var btnTest = function btnTest() {\n    console.log(workerList[0]);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Main, {\n    style: {\n      minHeight: winSize[1]\n    },\n    children: resultPage ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: '400px',\n        margin: '80px 0'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            style: {\n              display: 'flex',\n              width: '400px',\n              height: '20px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                width: '60%',\n                border: '1px solid #bfbfbf'\n              },\n              children: \"\\uC774\\uB984\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 29\n            }, _this2), /*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                width: '40%',\n                border: '1px solid #bfbfbf'\n              },\n              children: \"\\uADFC\\uBB34 \\uC2DC\\uAC04\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 29\n            }, _this2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 25\n          }, _this2)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 21\n        }, _this2), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: workerList.map(function (v, i) {\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              style: {\n                display: 'flex',\n                width: '400px',\n                height: '30px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                style: {\n                  display: 'flex',\n                  justifyContent: 'center',\n                  alignItems: 'center',\n                  width: '60%',\n                  border: '1px solid #bfbfbf'\n                },\n                children: v.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 37\n              }, _this2), /*#__PURE__*/_jsxDEV(\"td\", {\n                style: {\n                  display: 'flex',\n                  justifyContent: 'center',\n                  alignItems: 'center',\n                  width: '40%',\n                  border: '1px solid #bfbfbf'\n                },\n                children: v.getSum()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 37\n              }, _this2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 33\n            }, _this2);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 21\n        }, _this2)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 17\n      }, _this2)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 13\n    }, _this2) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(FileInput, {\n        children: [\"\\uD30C\\uC77C \\uC62C\\uB9AC\\uAE30\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          style: {\n            display: 'none'\n          },\n          onChange: parseFile\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 17\n        }, _this2)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 13\n      }, _this2), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: getResult,\n        children: \"\\uACB0\\uACFC \\uBCF4\\uAE30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 13\n      }, _this2)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 200,\n    columnNumber: 9\n  }, _this2);\n};\n\n_s(Home, \"lOspmBfIDmeQCjIZq9pPgBIKLVo=\", false, function () {\n  return [useWindowSize];\n});\n\n_c5 = Home;\nexport default Home;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"Main\");\n$RefreshReg$(_c2, \"FileInput\");\n$RefreshReg$(_c3, \"Button\");\n$RefreshReg$(_c4, \"Worker\");\n$RefreshReg$(_c5, \"Home\");","map":{"version":3,"sources":["/Users/taeeun/Desktop/Programming/Projects/work-time-calc/pages/index.js"],"names":["React","useState","styled","useWindowSize","useInput","Main","main","FileInput","label","Button","button","Worker","name","workTime","bound","getSum","reduce","result","data","b_idx","_res","_d","i","length","getElem","sheet","R","tmp","XLSX","utils","encode_cell","c","r","elem","t","format_cell","Home","winSize","mainFile","setMainFile","workerList","setWorkerList","resultPage","setResultPage","fileUploaded","setFileUploaded","parseFile","e","reader","FileReader","onload","fileData","wb","read","type","firstSheetName","SheetNames","Sheets","mainSheet","range","decode_range","rowData","push","alert","target","files","readAsBinaryString","getResult","sort","a","b","workers","idx","rows","_worker","curDay","cur","forEach","row","beginDay","split","endDay","undefined","Array","fill","beginTime","parseInt","endTime","btnTest","console","log","minHeight","width","margin","display","height","justifyContent","alignItems","border","map","v"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport styled from 'styled-components';\nimport useWindowSize from '../hooks/useWindowSize';\nimport useInput from '../hooks/useInput';\n\nconst Main = styled.main`\n    background-color:#eceae9;\n\n    display:flex;\n    flex-direction:column;\n    justify-content:center;\n    align-items:center;\n`;\n\nconst FileInput = styled.label`\n    color:#4c4a49;\n    font-family: 'GmarketSansMedium', '나눔고딕', NanumGothic, '돋움', Dotum, sans-serif;\n    font-size: 3.5rem;\n    line-height:2;\n    text-shadow:1px 1px 1px #5c5a59;\n\n    &:hover {\n        transform: scale(1.1);\n        transition: all 0.1s ease;\n    };\n`;\n\nconst Button = styled.button`\n    color:#4c4a49;\n    font-family: 'GmarketSansMedium', '나눔고딕', NanumGothic, '돋움', Dotum, sans-serif;\n    font-size: 3.5rem;\n    line-height:2;\n    text-shadow:1px 1px 1px #5c5a59;\n\n    &:hover {\n        transform: scale(1.1);\n        transition: all 0.1s ease;\n    };\n`;\n\nfunction Worker(name) {\n    this.name = name;\n    this.workTime = [];\n    this.bound = [];\n\n    this.getSum = () => {\n        return this.workTime.reduce((result, data, b_idx) => {\n            return result + data.reduce((_res, _d, i) => {\n                if(_d === 0 && data[i-1] === 1) {\n                    _res--;\n                } else if(i === data.length-1 && _d === 1) {\n                    _res--;\n                }\n                return _res + _d;\n            }, 0)/2 - this.bound[b_idx]/2;\n        }, 0);\n    }\n}\n\nconst getElem = (sheet, i, R) => {\n    let tmp = sheet[XLSX.utils.encode_cell({c:i, r:R})]\n    let elem = 'UNKNOWN';\n    if(tmp && tmp.t) elem = XLSX.utils.format_cell(tmp);\n\n    return elem;\n}\n\nconst Home = () => {\n    const winSize = useWindowSize();\n    const [mainFile, setMainFile] = useState(null);\n    const [workerList, setWorkerList] = useState(null);\n    const [resultPage, setResultPage] = useState(false);\n    const [fileUploaded, setFileUploaded] = useState(false);\n\n    const parseFile = (e) => {\n        const reader = new FileReader();\n    \n        reader.onload = () => {\n            const fileData =  reader.result;\n            const wb = XLSX.read(fileData, {type : 'binary'});\n            const firstSheetName = wb.SheetNames[0];\n            const sheet = wb.Sheets[firstSheetName];\n            \n            const mainSheet = []; \n            let range = XLSX.utils.decode_range(sheet['!ref']);\n\n            for(let R=2; R<=range.e.r; ++R) {\n                let rowData = [];\n                \n                rowData.push(getElem(sheet, 0, R));\n                rowData.push(getElem(sheet, 1, R));\n                rowData.push(getElem(sheet, 2, R));\n\n                mainSheet.push(rowData);\n            }\n\n            setMainFile(mainSheet);\n        }\n        \n        alert(`${e.target.files[0].name}이 정상적으로 업로드 되었습니다`);\n        reader.readAsBinaryString(e.target.files[0]);\n    };\n\n    const getResult = () => {\n        mainFile.sort((a, b) => {\n            if(a[0] < b[0]) {\n                return -1;\n            } else if(a[0] > b[0]) {\n                return 1;\n            } else {\n                if(a[1] < b[1]) {\n                    return -1;\n                } else if(a[1] > b[1]) {\n                    return 1;\n                }\n\n                return 0;\n            }\n        });\n\n        const workers = []; // array of Worker\n        let idx = 0;\n        while(idx < mainFile.length) {\n            const name = mainFile[idx][0];\n            if(name === 'UNKNOWN') {\n                idx++;\n                continue;\n            }\n\n            const rows = []\n            const _worker = new Worker(name);\n\n            while(idx < mainFile.length && mainFile[idx][0] === name) rows.push(mainFile[idx++]);\n\n            let curDay = '';\n            let cur = -1;\n            rows.forEach(row => {\n                const beginDay = row[1].split(' ')[0];\n                const endDay = row[2].split(' ')[0];\n\n                if(curDay !== beginDay) {\n                    if(_worker.workTime[cur+1] === undefined) {\n                        _worker.workTime.push(Array(49).fill(0));\n                    }\n                    if(_worker.bound[cur+1] === undefined) {\n                        _worker.bound.push(0);\n                    }\n                    curDay = beginDay;\n                    cur++;\n                }\n\n                const beginTime = parseInt(row[1].split(' ')[2].split(':')[0]) + (row[1].split(' ')[2].split(':')[1] == 0 ? 0 : 0.5);\n                const endTime = parseInt(row[2].split(' ')[2].split(':')[0]) + (row[2].split(' ')[2].split(':')[1] == 0 ? 0 : 0.5);\n\n                if(beginDay === endDay) {\n                    if(beginTime !== 0 && _worker.workTime[cur][beginTime*2] === 0 && _worker.workTime[cur][beginTime*2 - 1] === 1) {\n                        _worker.bound[cur]++;\n                    }\n                    if(endTime !== 48 && _worker.workTime[cur][endTime*2] === 0 && _worker.workTime[cur][endTime*2 + 1] === 1) {\n                        _worker.bound[cur]++;\n                    }\n                    for(let i=beginTime*2; i<=endTime*2; i++) {\n                        _worker.workTime[cur][i] = 1;\n                    }\n                } else {\n                    if(_worker.workTime[cur+1] === undefined) {\n                        _worker.workTime.push(Array(49).fill(0));\n                    }\n                    if(_worker.bound[cur+1] === undefined) {\n                        _worker.bound.push(0);\n                    }\n\n                    if(beginTime !== 0 && _worker.workTime[cur][beginTime*2] === 0 && _worker.workTime[cur][beginTime*2 - 1] === 1) {\n                        _worker.bound[cur]++;\n                    }\n                    if(endTime !== 48 && _worker.workTime[cur+1][endTime*2] === 0 && _worker.workTime[cur+1][endTime*2 + 1] === 1) {\n                        _worker.bound[cur]++;\n                    }\n                    for(let i=beginTime*2; i<49; i++) {\n                        _worker.workTime[cur][i] = 1;\n                    }\n                    for(let i=0; i<=endTime*2; i++) {\n                        _worker.workTime[cur+1][i] = 1;\n                    }\n                }\n            });\n\n            workers.push(_worker);\n        }\n\n        setWorkerList(workers);\n        setResultPage(true);\n    };\n\n    const btnTest = () => {\n        console.log(workerList[0]);\n    }\n\n    return (\n        <Main style={{minHeight:winSize[1]}}>\n            {resultPage ?\n            <div style={{width:'400px', margin:'80px 0'}}>\n                <table>\n                    <thead>\n                        <tr style={{\n                            display:'flex',\n                            width:'400px',\n                            height:'20px',\n                        }}>\n                            <th style={{\n                                display:'flex',\n                                justifyContent:'center',\n                                alignItems:'center',\n                                width:'60%',\n                                border:'1px solid #bfbfbf'\n                            }}>\n                                이름\n                            </th>\n                            <th style={{\n                                display:'flex',\n                                justifyContent:'center',\n                                alignItems:'center',\n                                width:'40%',\n                                border:'1px solid #bfbfbf'\n                            }}>\n                                근무 시간\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {workerList.map((v, i) => {\n                            return (\n                                <tr style={{\n                                    display:'flex',\n                                    width:'400px',\n                                    height: '30px'\n                                }}>\n                                    <td style={{\n                                        display:'flex',\n                                        justifyContent:'center',\n                                        alignItems:'center',\n                                        width:'60%',  \n                                        border:'1px solid #bfbfbf'\n                                    }}>\n                                        {v.name}\n                                    </td>\n                                    <td style={{\n                                        display:'flex',\n                                        justifyContent:'center',\n                                        alignItems:'center',\n                                        width:'40%',  \n                                        border:'1px solid #bfbfbf'\n                                    }}> \n                                        {v.getSum()}\n                                    </td>\n                                </tr>\n                            );\n                        })}\n                    </tbody>\n                </table>\n            </div> :\n            <>\n            <FileInput>\n                파일 올리기\n                <input type=\"file\" style={{display:'none'}} onChange={parseFile} />\n            </FileInput>\n            <Button onClick={getResult}>\n                결과 보기\n            </Button>\n            </>}\n        </Main>\n    );\n};\n\nexport default Home;"]},"metadata":{},"sourceType":"module"}